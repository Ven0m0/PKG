# shellcheck enable=all shell=bash source-path=SCRIPTDIR external-sources=true
pkgname=intel-ucode-scan
pkgver=1.0.0
pkgrel=1
pkgdesc="Pacman hook + helper: generate per-CPU intel microcode image and rebuild initramfs"
arch=('x86_64')
url="https://example.local/intel-ucode-scan"
license=('MIT')
depends=('mkinitcpio')
optdepends=('intel-ucode: intel microcode firmware'
            'iucode_tool: required to build per-CPU microcode images (runtime)')
source=("assets/99-intel-ucode-scan.hook"
        "assets/intel-ucode-scan.sh"
        "intel-ucode-scan.install")
sha256sums=('0b212b3614c79ed55033e25ebf4c5a53668d31e957152b20b09e582a98674d08'
            '40b567eb6f077286bf60982577f99e62b81a111e01364fdf49ce8c5da150b430'
            '2f9bb079fbdacfe05f96042a8ee428936a42a847cd18dca256f2bc0b6273fc80')

build(){ return 0; }

package(){
  install -Dm644 "$srcdir/assets/99-intel-ucode-scan.hook" "$pkgdir/etc/pacman.d/hooks/99-intel-ucode-scan.hook"
  install -Dm755 "$srcdir/assets/intel-ucode-scan.sh" "$pkgdir/usr/local/bin/intel-ucode-scan.sh"
}

# vim:set sw=2 sts=2 et:
