pkgname=intel-ucode-scan
pkgver=1.0.0
pkgrel=1
pkgdesc="Pacman hook + helper: generate per-CPU intel microcode image and rebuild initramfs"
arch=('x86_64')
url="https://example.local/intel-ucode-scan"
license=('MIT')
depends=('mkinitcpio')
optdepends=('intel-ucode: intel microcode firmware'
            'iucode_tool: required to build per-CPU microcode images (runtime)')
source=("assets/99-intel-ucode-scan.hook"
        "assets/intel-ucode-scan.sh"
        "intel-ucode-scan.install")
sha256sums=('SKIP' 'SKIP' 'SKIP')

build() {
  return 0
}

package() {
  # install hook
  install -Dm644 "$srcdir/assets/99-intel-ucode-scan.hook" \
    "$pkgdir/etc/pacman.d/hooks/99-intel-ucode-scan.hook"

  # install helper script (preserve earlier chosen path)
  install -Dm755 "$srcdir/assets/intel-ucode-scan.sh" \
    "$pkgdir/usr/local/bin/intel-ucode-scan.sh"

  # keep .install in srcdir (makepkg will pack it automatically)
  # no other runtime files needed
}
